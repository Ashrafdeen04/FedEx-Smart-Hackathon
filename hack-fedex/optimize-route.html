<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Enhanced Route Optimizer</title>
  <style>
    /* Global Styling */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Poppins', sans-serif;
    }

    body {
      background: linear-gradient(
        rgba(0, 0, 0, 0.6),
        rgba(0, 0, 0, 0.6)
      ), url('https://img.freepik.com/premium-photo/co2-carbon-emission-from-car-pollution_1240525-107447.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 150vh;
    }

    .container {
      max-width: 1200px;
      width: 90%;
      display: flex;
      background: rgba(0, 0, 0, 0.8);
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.5);
    }

    .form-section {
      flex: 2;
      padding: 40px;
    }

    .sidebar {
      flex: 1;
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      color: #fff;
    }

    h2 {
      text-align: center;
      margin-bottom: 30px;
      font-size: 28px;
      color: #9aeff2;
    }

    label {
      display: block;
      margin-bottom: 10px;
      font-size: 18px;
      color: #d6dce0;
    }

    input, select {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border-radius: 6px;
      border: none;
      font-size: 16px;
      background: #fff;
      color: #000;
    }

    button {
      width: 100%;
      padding: 15px;
      border: none;
      border-radius: 6px;
      font-size: 18px;
      font-weight: bold;
      background: linear-gradient(to right, #ff416c, #ff4b2b);
      color: white;
      cursor: pointer;
      transition: transform 0.2s, background 0.3s;
    }

    button:hover {
      transform: scale(1.05);
      background: linear-gradient(to right, #ff4b2b, #ff416c);
    }

    .sidebar h3 {
      font-size: 20px;
      margin-bottom: 15px;
      color: #9aeff2;
    }

    .data-block {
      background: rgba(255, 255, 255, 0.2);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .data-block h4 {
      font-size: 18px;
      margin-bottom: 10px;
      color: #ffcc00;
    }

    #map {
      height: 400px;
      margin-top: 20px;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Form Section -->
    <div class="form-section">
      <h2>Enhanced Route Optimizer</h2>
      <form id="route-form">
        <label for="vehicle-type">Vehicle Type</label>
        <select id="vehicle-type" required>
          <option value="">Select Vehicle Type</option>
          <option value="car">Car</option>
          <option value="bike">Bike</option>
          <option value="bus">Bus</option>
          <option value="truck">Truck</option>
        </select>

        <label for="origin">Origin</label>
        <div style="display: flex; gap: 10px;">
          <input type="text" id="origin" placeholder="Enter origin address" required>
          <button type="button" class="voice-button" onclick="startVoiceInput('origin')">ðŸŽ¤</button>
        </div>

        <label for="destination">Destination</label>
        <div style="display: flex; gap: 10px;">
          <input type="text" id="destination" placeholder="Enter destination address" required>
          <button type="button" class="voice-button" onclick="startVoiceInput('destination')">ðŸŽ¤</button>
        </div>

        <button type="submit">Calculate Optimal Routes</button>
      </form>
      <div id="routes-container"></div>
      <div id="map"></div>
    </div>

    <!-- Sidebar Section -->
    <div class="sidebar">
      <h3>Real-Time Data</h3>
      <div class="data-block" id="traffic-data">
        <h4>Traffic Data</h4>
        <p>Loading...</p>
      </div>
      <div class="data-block" id="aqi-data">
        <h4>Air Quality Data</h4>
        <p>Loading...</p>
      </div>
    </div>
  </div>

  <script>
    let map, directionsService, directionsRenderer;

    const AQICN_API_KEY = 'd4f26403a3da5dab3a04d309df4612da5dfdfcfd';
    const TOM_TOM_API_KEY = 'FURUmeXJFsVAxfbjrBrCRBXrEsBFbRlx';

    // Initialize Google Maps
    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        center: { lat: 20.5937, lng: 78.9629 },
        zoom: 5,
      });

      directionsService = new google.maps.DirectionsService();
      directionsRenderer = new google.maps.DirectionsRenderer({ map });
    }

    function startVoiceInput(inputId) {
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = "en-US";

      recognition.onresult = (event) => {
        const voiceInput = event.results[0][0].transcript;
        document.getElementById(inputId).value = voiceInput;
      };

      recognition.start();
    }

    function fetchTrafficData(origin, destination) {
      const url = `https://api.tomtom.com/routing/1/calculateRoute/${origin}:${destination}/json?key=${TOM_TOM_API_KEY}&traffic=true`;
      fetch(url)
        .then(response => response.json())
        .then(data => {
          const trafficInfo = data.routes?.[0]?.summary;
          if (trafficInfo) {
            document.getElementById('traffic-data').innerHTML = `
              <h4>Traffic Data</h4>
              <p><strong>Distance:</strong> ${(trafficInfo.lengthInMeters / 1000).toFixed(2)} km</p>
              <p><strong>Travel Time:</strong> ${(trafficInfo.travelTimeInSeconds / 60).toFixed(2)} mins</p>
            `;
          } else {
            document.getElementById('traffic-data').innerHTML = `<p>No traffic data available.</p>`;
          }
        })
        .catch(error => console.error('Error fetching traffic data:', error));
    }

    function fetchAirQualityData(location) {
      const url = `https://api.waqi.info/feed/${location}/?token=${AQICN_API_KEY}`;
      fetch(url)
        .then(response => response.json())
        .then(data => {
          const aqi = data.data.aqi;
          const pollutant = data.data.dominentpol;
          document.getElementById('aqi-data').innerHTML = `
            <h4>Air Quality Data</h4>
            <p><strong>AQI:</strong> ${aqi}</p>
            <p><strong>Dominant Pollutant:</strong> ${pollutant}</p>
          `;
        })
        .catch(error => console.error('Error fetching air quality data:', error));
    }

    function calculateRoute(event) {
      event.preventDefault();
      const origin = document.getElementById('origin').value;
      const destination = document.getElementById('destination').value;
      const vehicleType = document.getElementById('vehicle-type').value;

      if (!origin || !destination || !vehicleType) {
        alert('Please fill all the fields!');
        return;
      }

      let travelMode = google.maps.TravelMode.DRIVING;
      if (vehicleType === 'bike') travelMode = google.maps.TravelMode.BICYCLING;

      const request = {
        origin,
        destination,
        travelMode,
        provideRouteAlternatives: true,
      };

      directionsService.route(request, (result, status) => {
        if (status === google.maps.DirectionsStatus.OK) {
          directionsRenderer.setDirections(result);
          const routesContainer = document.getElementById('routes-container');
          routesContainer.innerHTML = '';

          result.routes.forEach((route, index) => {
            const distance = route.legs.reduce((sum, leg) => sum + leg.distance.value, 0) / 1000;
            const duration = route.legs.reduce((sum, leg) => sum + leg.duration.value, 0) / 60;

            const routeOption = document.createElement('div');
            routeOption.className = 'data-block';
            routeOption.innerHTML = `
              <h4>Route ${index + 1}</h4>
              <p><strong>Distance:</strong> ${distance.toFixed(2)} km</p>
              <p><strong>Time:</strong> ${duration.toFixed(2)} mins</p>
            `;
            routeOption.onclick = () => directionsRenderer.setRouteIndex(index);

            routesContainer.appendChild(routeOption);
          });

          fetchTrafficData(origin, destination);
          fetchAirQualityData(origin);
        } else {
          alert('Could not calculate routes. Please try again.');
        }
      });
    }

    document.getElementById('route-form').addEventListener('submit', calculateRoute);

    function loadGoogleMapsAPI() {
      const script = document.createElement('script');
      script.src = `https://maps.googleapis.com/maps/api/js?key=AIzaSyA-S3DIud4-b9h9dVs4hnlVBGMfr_TtHx0&libraries=places&callback=initMap`;
      script.async = true;
      script.defer = true;
      document.body.appendChild(script);
    }

    loadGoogleMapsAPI();
  </script>
</body>
</html>
